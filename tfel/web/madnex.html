<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-EN" xml:lang="en-EN">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Support of madnex files in MFront</title>
        <meta name="author" content="Thomas Helfer" />
            <meta name="date" content="2020-01-01" />
        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <style type="text/css">code{white-space: pre;}</style>
            <style type="text/css">
      a.sourceLine { display: inline-block; line-height: 1.25; }
      a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
      a.sourceLine:empty { height: 1.2em; position: absolute; }
      .sourceCode { overflow: visible; }
      code.sourceCode { white-space: pre; position: relative; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      code.sourceCode { white-space: pre-wrap; }
      a.sourceLine { text-indent: -1em; padding-left: 1em; }
      }
      pre.numberSource a.sourceLine
        { position: relative; }
      pre.numberSource a.sourceLine:empty
        { position: absolute; }
      pre.numberSource a.sourceLine::before
        { content: attr(data-line-number);
          position: absolute; left: -5em; text-align: right; vertical-align: baseline;
          border: none; pointer-events: all;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        { background-color: #f8f8f8; }
      @media screen {
      a.sourceLine::before { text-decoration: underline; }
      }
      code span.al { color: #ef2929; } /* Alert */
      code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #c4a000; } /* Attribute */
      code span.bn { color: #0000cf; } /* BaseN */
      code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4e9a06; } /* Char */
      code span.cn { color: #000000; } /* Constant */
      code span.co { color: #8f5902; font-style: italic; } /* Comment */
      code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
      code span.dt { color: #204a87; } /* DataType */
      code span.dv { color: #0000cf; } /* DecVal */
      code span.er { color: #a40000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #0000cf; } /* Float */
      code span.fu { color: #000000; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
      code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
      code span.ot { color: #8f5902; } /* Other */
      code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
      code span.sc { color: #000000; } /* SpecialChar */
      code span.ss { color: #4e9a06; } /* SpecialString */
      code span.st { color: #4e9a06; } /* String */
      code span.va { color: #000000; } /* Variable */
      code span.vs { color: #4e9a06; } /* VerbatimString */
      code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
            <link rel="stylesheet" href="css/normalize.css"/>
    <link rel="stylesheet" href="css/main.css"/>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
          </head>
  <body>
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
        <header>
      <ul id="nav">
	<li><a href="news.html">News</a></li>
	<li><a href="index.html">Overview</a>
	  <ul>
	    <li><a>Domain specific languages</a>
	      <ul>
		<li><a href="material-properties.html">Material properties</a></li>
		<li><a href="behaviours.html">Mechanical behaviours</a></li>
		<li><a href="models.html">Models</a></li>
	      </ul>
            </li>
	    <li><a href="interfaces.html">Interfaces</a></li>
	    <li><a href="mfront-doc.html">mfront-doc</a></li>
	    <li><a href="mtest.html">mtest</a></li>
	    <li><a href="mfm.html">mfm</a></li>
	    <li><a href="mfm-test-generator.html">mfm</a></li>
	  </ul>
	</li>
	<li><a>Getting started</a>
	  <ul>
	    <li><a href="https://sourceforge.net/projects/tfel/files">Download</a></li>
	    <li><a href="release-notes.html">Release notes</a>
	    <ul>
            <li><a>Versions 2.0.x</a>
                <ul>
                <li><a href="release-notes.html">Versions prior to 2.0.5</a><li>
	 	       <li><a href="release-notes-2.0.5.html">Version 2.0.5</a><li>
                </ul>
            </li>
            <li><a>Versions 3.0.x</a>
                <ul>
                    <li><a href="release-notes-3.0.html">Version 3.0.0</a><li>
		           <li><a href="release-notes-3.0.1.html">Version 3.0.1</a><li>
                    <li><a href="release-notes-3.0.2.html">Version 3.0.2</a><li>
		           <li><a href="release-notes-3.0.3.html">Version 3.0.3</a><li>
		           <li><a href="release-notes-3.0.4.html">Version 3.0.4</a><li>
		           <li><a href="release-notes-3.0.5.html">Version 3.0.5</a><li>
		           <li><a href="release-notes-3.0.6.html">Version 3.0.6</a><li>
                </ul>
           </li>
            <li><a>Versions 3.1.x</a>
                <ul>
		<li><a href="release-notes-3.1.html">Version 3.1.0</a><li>
		<li><a href="release-notes-3.1.1.html">Version 3.1.1</a><li>
		<li><a href="release-notes-3.1.2.html">Version 3.1.2</a><li>
		<li><a href="release-notes-3.1.3.html">Version 3.1.3</a><li>
		<li><a href="release-notes-3.1.4.html">Version 3.1.4</a><li>
		<li><a href="release-notes-3.1.5.html">Version 3.1.5</a><li>
                </ul>
           </li>
            <li><a>Versions 3.2.x</a>
                <ul>
		           <li><a href="release-notes-3.2.html">Version 3.2.0</a><li>
		           <li><a href="release-notes-3.2.1.html">Version 3.2.1</a><li>
		           <li><a href="release-notes-3.2.2.html">Version 3.2.2</a><li>
                </ul>
           </li>
            <li><a>Versions 3.3.x</a>
                <ul>
		           <li><a href="release-notes-3.3.html">Version 3.3.0</a><li>
		           <li><a href="release-notes-3.3.1.html">Version 3.3.1</a><li>
                </ul>
           </li>
            <li><a>Versions 3.4.x</a>
                <ul>
		           <li><a href="release-notes-3.4.html">Version 3.4.0</a><li>
                </ul>
           </li>
	      </ul>
	    </li>
	    <li><a href="coverity-scan.html">Coverity scan</a></li>
	    <li><a href="install.html">Installation</a></li>
	  </ul>
	</li>
	<li><a>Documentation</a>
	  <ul>
	    <li><a href="documentations.html">General documentation</a></li>
	    <li><a href="gallery.html">Gallery</a></li>
	    <li><a href="http://tfel.sourceforge.net/doxygen/index.html">Doxygen documentation</a></li>
	    <li><a>Behaviours</a>
	      <ul>
		<li><a href="tutorial.html">Tutorial</a></li>
		<li><a href="implicit-dsl.html">The implicit DSL</a></li>
		<li><a href="benchmark.html">Benchmark</a></li>
		<li><a href="parameters.html">Parameters</a></li>
		<li><a href="BehaviourBricks.html">Behaviour bricks</a></li>
		<li><a href="interfaces.html">Solver interfaces</a>
		  <ul>
		    <li><a href="castem.html">Cast3M</a></li>
		    <li><a href="aster.html">Code-Aster</a></li>
    		    <li><a href="abaqus.html">Abaqus</a></li>
    		    <li><a href="epx.html">EUROPLEXUS</a></li>
		    <li><a href="zmat.html">ZeBuLoN</a></li>
   		    <li><a href="calculix.html">CalculiX</a></li>
		    <!-- <li><a >TMFFT</a></li> -->
		    <li><a href="cyrano.html">Cyrano</a></li>
   		    <li><a href="generic-behaviours-interface.html">Generic Behaviour Interface</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a>TFEL libraries</a>
	      <ul>
		<li><a href="material.html">TFEL/Material</a></li>
	      </ul>
	    </li>
	    <li><a>Python modules</a>
	      <ul>
		<li><a href="tfel-python.html">TFEL modules</a></li>
		<li><a href="mfront-python.html">mfront module</a></li>
		<li><a href="mtest-python.html">mtest module</a></li>
	      </ul>
	    </li>
	    <li><a>MFront keywords</a>
	      <ul>
		<li><a href="DefaultDSL-keywords.html">DefaultDSL</a></li> 
		<li><a href="DefaultCZMDSL-keywords.html">DefaultCZMDSL</a></li> 
		<li><a href="DefaultFiniteStrainDSL-keywords.html">DefaultFiniteStrainDSL</a></li> 
		<li><a href="Implicit-keywords.html">Implicit</a></li> 
		<li><a href="ImplicitFiniteStrain-keywords.html">ImplicitFiniteStrain</a></li> 
		<li><a href="ImplicitII-keywords.html">ImplicitII</a></li> 
		<li><a href="IsotropicMisesCreep-keywords.html">IsotropicMisesCreep</a></li> 
		<li><a href="IsotropicPlasticMisesFlow-keywords.html">IsotropicPlasticMisesFlow</a></li> 
		<li><a href="IsotropicStrainHardeningMisesCreep-keywords.html">IsotropicStrainHardeningMisesCreep</a></li> 
		<li><a href="MaterialLaw-keywords.html">MaterialLaw</a></li> 
		<li><a href="Model-keywords.html">Model</a></li> 
		<li><a href="MultipleIsotropicMisesFlows-keywords.html">MultipleIsotropicMisesFlows</a></li> 
		<li><a href="RungeKutta-keywords.html">RungeKutta</a></li> 
	      </ul>
	    </li>
	    <li><a href="MTest-keywords.html">MTest keywords</a></li>
	    <li><a href="physical-constants.html">Physical constants</a></li>
	    <li><a href="glossary.html">Glossary</a></li>
	    <li><a href="publications.html">Publications</a></li>
	    <li><a href="faq.html">FAQ</a></li>
	    <li><a href="about.html">About</a></li>
	  </ul>
	</li>
	<li><a>Contributing</a>
	  <ul>
	    <li><a href="svn.html">Access to source repositories</a></li>
	    <li><a href="devel.html">Development guidelines</a></li>
	    <li><a href="http://sourceforge.net/p/tfel/tickets">Report bugs</a></li>
	  </ul>
	</li>
	<li><a>Getting Help</a>
	  <ul>
	    <li><a href="search.html">Search on this site</a></li>
	    <li><a href="http://sourceforge.net/p/tfel/discussion">Forum</a></li>
	    <li><a href="http://sourceforge.net/p/tfel/tfel">Mailing lists</a></li>
	    <li><a href="mailto:tfel-contact@cea.fr">Contact</a></li>
	  </ul>
	</li>
      </ul>
    </header>
    <br></br>
        <div id="header">
      <h1 class="title">Support of <code>madnex</code> files in <code>MFront</code></h1>
                  <h2 class="author">Thomas Helfer</h2>
                  <h3 class="date">2020</h3>
          </div>
            <div id="TOC">
      <ul>
      <li><a href="#compilation-of-tfel-with-madnex-files-support">Compilation of <code>TFEL</code> with <code>madnex</code> files support</a></li>
      <li><a href="#mfront-usage"><code>mfront</code> usage</a></li>
      <li><a href="#mfront-python-module"><code>mfront</code> python module</a></li>
      <li><a href="#mfront-query-usage"><code>mfront-query</code> usage</a><ul>
      <li><a href="#options-specific-to-madnex-files">Options specific to <code>madnex</code> files</a></li>
      <li><a href="#querying-information-about-implementation-options-specific-to-madnex-files">Querying information about implementation, options specific to <code>madnex</code> files</a></li>
      </ul></li>
      <li><a href="#references">References</a></li>
      </ul>
    </div>
        <p>The <code>madnex</code> file format has been developed by <code>EDF</code> to store their experimental data. It extends the <code>HDF5</code> file format by providing a suitable data model. Internally, <code>EDF</code> uses a closed-source <code>python</code> library to insert, query and extract data from <code>madnex</code> file.</p>
<p>The <code>madnex</code> library is an open-source <code>C++</code> library which currently focus on the storage of <code>MFront</code> implementations. This library can be downloaded here:</p>
<p><a href="https://github.com/thelfer/madnex" class="uri">https://github.com/thelfer/madnex</a></p>
<p>The website of this library <span class="citation" data-cites="cea_edf_madnex_library_2020">(CEA <a href="#ref-cea_edf_madnex_library_2020">2020</a>)</span> details the data model used to store <code>MFront</code> implementations [@].</p>
<h1 id="compilation-of-tfel-with-madnex-files-support">Compilation of <code>TFEL</code> with <code>madnex</code> files support</h1>
<p>By default, support of <code>madnex</code> files is disabled.</p>
<p>Support for <code>madnex</code> files as inputs of <code>MFront</code> must be explicitly enabled during the compilation of the <code>TFEL</code> project. More precisely, when invoking the <a href="https://cmake.org/"><code>cmake</code></a> build system, the following variables must be set:</p>
<ol type="1">
<li><code>enable-madnex</code> must be set to <code>ON</code>.</li>
<li><code>Madnex_DIR</code> must be set to the path where the <code>MadnexConfig.cmake</code> file has been installed. This path is usually given by <code>$MADNEXHOME/share/madnex/cmake/</code> where <code>MADNEXHOME</code> is the installation directory of the <code>madnex</code> library.</li>
</ol>
<p>Hence, a typical call <code>cmake</code> to cmake would be similar as:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1">$ <span class="fu">cmake</span> -Denable-madnex=ON -DMadnex_DIR=<span class="va">$MADNEXHOME</span>/share/madnex/cmake ...</a></code></pre></div>
<p>This call assumes that that the <code>MADNEXHOME</code> environment variable has been set.</p>
<p>More information about the options that can be passed to <code>cmake</code> are given in the <code>INSTALL-cmake</code> file which is located at the root of the <code>TFEL</code> sources.</p>
<h1 id="mfront-usage"><code>mfront</code> usage</h1>
<p>The only thing specific to <code>madnex</code> files is the selection of the implementation to be treated.</p>
<p>For a behaviour, this selection is done through the <code>--material</code> and <code>--behaviour</code> options. For example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1">$ <span class="ex">mfront</span> --obuild --interface=generic --material=<span class="op">&lt;</span>material_id<span class="op">&gt;</span> --behaviour=<span class="op">&lt;</span>behaviour_id<span class="op">&gt;</span> file.madnex</a></code></pre></div>
<p>Here, <code>behaviour_id</code> can be a regular expression.</p>
<p>For material properties and models, the <code>--material-property</code> and <code>--model</code> options have a similar role than the <code>--behaviour</code> option for behaviours.</p>
<p>The <code>--all-material-properties</code>, <code>--all-behaviours</code>, and <code>--all-models</code> options allows to select all the material properties, behaviours and models respectively, as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1">$ <span class="ex">mfront</span> --obuild --interface=generic --material=<span class="op">&lt;</span>material_id<span class="op">&gt;</span> --all-behaviours file.madnex</a></code></pre></div>
<p>The material name <code>&lt;none&gt;</code> has a special meaning here: it allows the selection of implementations that not associated with a material.</p>
<h1 id="mfront-python-module"><code>mfront</code> python module</h1>
<p>The <code>mfront</code> python module is fully described here:</p>
<p><a href="http://tfel.sourceforge.net/mfront-python.html" class="uri">http://tfel.sourceforge.net/mfront-python.html</a></p>
<p>The main function related to <code>madnex</code> file support is the <code>getMFrontImplementationsPaths</code> which takes five arguments:</p>
<ul>
<li>the name of the file. The name of this argument is <code>file</code>;</li>
<li>the name of a material. If the material name is empty, the implementations associated with all the materials are are considered and also the implementations associated with no material. To select only implementations associated with no material, one shall use the special material name <code>&lt;none&gt;</code>. The name of this argument is <code>material</code>.</li>
<li>a regular expression describing the searched material properties. This argument can be empty. The name of this argument is <code>material_property</code>.</li>
<li>a regular expression describing the searched behaviours. This argument can be empty. The name of this argument is <code>behaviour</code>.</li>
<li>a regular expression describing the searched models. This argument can be empty. The name of this argument is <code>model</code>.</li>
</ul>
<p>This function returns a list of strings where the path of the implementation is encoded.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="im">import</span> mfront</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">paths <span class="op">=</span> mfront.getMFrontImplementationsPaths(<span class="st">&quot;file.madnex&quot;</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                                             material<span class="op">=&lt;</span>material_id<span class="op">&gt;</span>,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                                             behaviour<span class="op">=</span>behaviour_id<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="cf">if</span> <span class="bu">len</span>(paths) <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  <span class="cf">raise</span>(<span class="st">&quot;no matching implementation&quot;</span>)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">dsl <span class="op">=</span> mfront.getDSL(paths[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">dsl.analyseFile(paths[<span class="dv">0</span>])</a></code></pre></div>
<h1 id="mfront-query-usage"><code>mfront-query</code> usage</h1>
<h2 id="options-specific-to-madnex-files">Options specific to <code>madnex</code> files</h2>
<p>Several options has been added to the <code>mfront-query</code> specifically for <code>madnex</code> files.</p>
<p>Queries of the file itself (list of materials, behaviours, etc…) are also provided by the <code>madnex-query</code> tool.</p>
<h3 id="listing-all-material-a-madnex-file">Listing all material a <code>madnex</code> file</h3>
<p>The <code>--list-materials</code> returns the list of all materials in a <code>MFront</code> file:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1">$ <span class="kw">`</span><span class="ex">mfront-query</span><span class="kw">`</span> <span class="ex">--list-materials</span> file.madnex</a></code></pre></div>
<h3 id="listing-of-all-material-properties-all-behaviours-or-all-models">Listing of all material properties, all behaviours or all models</h3>
<p>The following options are available:</p>
<ul>
<li><code>--list-material-properties</code>: list of material properties.</li>
<li><code>--list-behaviours</code>: list of all behaviours.</li>
<li><code>--list-models</code>: list of all models.</li>
</ul>
<p>A typical call is as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1">$ <span class="kw">`</span><span class="ex">mfront-query</span><span class="kw">`</span> <span class="ex">--list-behaviours</span> file.madnex</a></code></pre></div>
<p>The previous options are affected by the the definition of a material, as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1">$ <span class="kw">`</span><span class="ex">mfront-query</span><span class="kw">`</span> <span class="ex">--material</span>=<span class="op">&lt;</span>material_id<span class="op">&gt;</span> --list-behaviours file.madnex</a></code></pre></div>
<h2 id="querying-information-about-implementation-options-specific-to-madnex-files">Querying information about implementation, options specific to <code>madnex</code> files</h2>
<p>For a behaviour, the selection of an implementation on which the queries are made is done through the <code>--material</code> and <code>--behaviour</code> options. For example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" data-line-number="1">$ <span class="ex">mfront-query</span> --obuild --interface=generic --material=<span class="op">&lt;</span>material_id<span class="op">&gt;</span> --behaviour=<span class="op">&lt;</span>behaviour_id<span class="op">&gt;</span> file.madnex --state-variables</a></code></pre></div>
<p>Here, <code>behaviour_id</code> can be a regular expression.</p>
<p>For material properties and models, the <code>--material-property</code> and <code>--model</code> options have a similar role than the <code>--behaviour</code> option for behaviours.</p>
<h1 id="references" class="unnumbered">References</h1>
<div id="refs" class="references">
<div id="ref-cea_edf_madnex_library_2020">
<p>CEA, EDF. 2020. “The ‘Madnex‘ Library.” 2020. <a href="https://thelfer.github.io/madnex/web/index.html" class="uri">https://thelfer.github.io/madnex/web/index.html</a>.</p>
</div>
</div>
        <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-62273823-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
